<!DOCTYPE html>
<html>
<head>
    <title>Debug Current Data</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .data-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Debug Current Data Structure</h1>
    
    <div class="data-section">
        <h2>Current Participants in localStorage</h2>
        <button onclick="showData()">Show Current Data</button>
        <button onclick="clearData()">Clear All Data</button>
        <button onclick="addTestData()">Add Test Data</button>
        <div id="data-output"></div>
    </div>

    <script>
        function showData() {
            const participants = JSON.parse(localStorage.getItem('participants') || '[]');
            const output = document.getElementById('data-output');
            
            if (participants.length === 0) {
                output.innerHTML = '<p>No participants found in localStorage</p>';
                return;
            }

            let html = '<h3>Found ' + participants.length + ' participants:</h3>';
            participants.forEach((p, index) => {
                html += `
                    <div style="border: 1px solid #ddd; margin: 10px 0; padding: 10px;">
                        <h4>Participant ${index + 1}</h4>
                        <pre>${JSON.stringify(p, null, 2)}</pre>
                    </div>
                `;
            });
            output.innerHTML = html;
        }

        function clearData() {
            localStorage.removeItem('participants');
            document.getElementById('data-output').innerHTML = '<p style="color: red;">All data cleared</p>';
        }

        function addTestData() {
            const testParticipant = {
                id: `NS-${Date.now().toString().slice(-8)}-${Math.floor(Math.random() * 10000).toString().padStart(4, '0')}`,
                firstName: 'John',
                lastName: 'Doe',
                participantName: 'John Doe',
                email: 'john.doe@example.com',
                status: 'completed',
                submissionDate: new Date().toISOString(),
                healthConditions: 'No significant health conditions',
                allergies: 'None',
                currentMedications: 'None',
                informedConsent: true,
                dataUsageConsent: true,
                dateOfBirth: '1990-01-01',
                phoneNumber: '555-0123',
                address: '123 Test St, Test City',
                emergencyContactName: 'Jane Doe',
                emergencyContactPhone: '555-0124',
                emergencyContactRelationship: 'Spouse'
            };

            const existingParticipants = JSON.parse(localStorage.getItem('participants') || '[]');
            existingParticipants.push(testParticipant);
            localStorage.setItem('participants', JSON.stringify(existingParticipants));
            
            document.getElementById('data-output').innerHTML = '<p style="color: green;">Test participant added successfully!</p>';
            setTimeout(showData, 1000);
        }

        // Auto-show data on load
        window.onload = showData;
    </script>
</body>
</html>
